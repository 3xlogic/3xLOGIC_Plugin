(function(e,t,n,r){var i={init:function(t){t.camera-=1;var n=t.camera;var r=this;var i=e.extend({},e._3xcloudSettings,t.settings);var s=e.extend({},e._3xcloudSettings.defaultConfig,t.config);var o=e("<div>").appendTo(this);e(o).css({width:"100%",height:"100%","background-color":"black"});var u=e(o);var a=function(){if(s.caption){e.getJSON(i.url+"/api/info/?callback=?",{key:i.apiKey,cam:n},function(t){var n=e("<label>").text(t[0].name);u.css({position:"relative"});e(n).appendTo(u);e(n).css({position:"absolute",top:"0","z-index":"2",left:"0",color:"white","background-color":"black",width:"100%","text-align":"center",opacity:"0.6"}).data("info",t[0]);if(s.captionStyle){e(n).css(s.captionStyle)}if(s.captionClass){e(n).addClass(s.captionClass)}})}};var f=function(){return u.width()+"x"+u.height()};var l=function(){if(e(r).find("img").data()._3xlogic){return e(r).find("img").data()._3xlogic.cam}else{return n}};var c=function(){if(e(r).find("img").data()._3xlogic){if(!e(r).find("img").data()._3xlogic.stream){return false}}};var h=function(){var e=Math.floor(Math.random()*1e12);var t=l();var n=i.url+"/api/video/?key="+i.apiKey+"&cam="+t;n+="&resolution="+f()+"&"+e;return n};var p=function(){var t=e("<img src='"+h()+"'>").data("_3xlogic",{url:i.url+"/api/video/?key="+i.apiKey+"&cam="+n,cam:n,config:s,setting:i,stream:true});return t};var d=function(){u.find("img").bind("load",function(){if(u.find("img").data()._3xlogic){if(!u.find("img").data()._3xlogic.stream){return false}}e(this).attr("src",h());if(!s.ratio){var t=e(this).width()/e(this).height();if(t<7&&t>2){e(this).attr("width","100%");if(e(this).height()>u.height()){e(this).css({height:u.height()+"px"})}e(this).css("margin-top",(u.height()-e(this).height())/2+u.scrollTop()+"px");e(this).css("margin-left",(u.width()-e(this).width())/2+u.scrollLeft()+"px")}else{e(this).css({width:"100%",height:"100%"})}}else{if(e(this).height()>u.height()){e(this).css({height:u.height()+"px"})}if(e(this).width()>u.width()){e(this).css({width:u.width()+"px"})}e(this).css("margin-top",(u.height()-e(this).height())/2+u.scrollTop()+"px");e(this).css("margin-left",(u.width()-e(this).width())/2+u.scrollLeft()+"px");var t=e(this).width()/e(this).height();if(t<7&&t>2){e(this).attr("width","100%")}}})};var v=e("<img src='"+i.url+"/resources/img/3xloader.png'/>").css({width:"100%",height:"100%"});e(u).html(v).delay(1e3).queue(function(){e(this).html(p());d();a()});return this},update:function(t){t-=1;var n=e(this).find("img").data()._3xlogic;n.cam=t;var r=this;if(n.config.caption){e.getJSON(n.setting.url+"/api/info/?callback=?",{key:n.setting.apiKey,cam:t},function(t){e(r).find("label").text(t[0].name)})}var i=e(this).height();var s=e(this).width();var o=n.setting.url+"/api/video/?key="+n.setting.apiKey+"&cam="+t+"&resolution="+s+"x"+i;e(this).find("img").attr("src",o);return this},pause:function(){e(this).find("img").data()._3xlogic.stream=false;return this},resume:function(){var t=e(this).find("img").data()._3xlogic;var n=t.url+"&resolution="+e(this).parent().width()+"x"+e(this).parent().height();t.stream=true;e(this).find("img").attr("src",n);return this},snapshot:function(){var t=e(this).find("img").data()._3xlogic;var n=t.cam;var r=t.setting.url+"/api/snapshot/?key="+t.setting.apiKey+"&cam="+n+"&resolution=fullsize";open(r,"_blank");return this},slideshow:function(t){if(typeof t==="object"||typeof t==="undefined"){var n=e.extend({},e._3xcloudSettings.slideShowDefault,t);var r=this;e(this).data("slideshow",{camera:0,run:true});var i=e(this).data().slideshow;if(n.cameras.length<1){return this}var s=n.cameras[0];e(this)._3xcloud({camera:s});var o=function(){var e=i.camera+1;if(e>n.cameras.length-1){i.camera=0;return n.cameras[0]}else{i.camera=e;return n.cameras[e]}};var u=function(){var e=i.camera-1;if(e<0){i.camera=n.cameras.length-1;return n.cameras[i.camera]}else{i.camera=e;return n.cameras[e]}};if(t.showMenu){e(this).css("position","relative");var a=e("<a>").text(">").css({position:"absolute",top:"50%",width:"30px",height:"30px","margin-top":"-30px",right:"15px","font-size":"40px","font-weight":"100","line-height":"30px",color:"white","text-align":"center",border:"3px solid white","border-radius":"23px","-webkit-border-radius":"23px","-moz-border-radius":"23px",background:"#222",opacity:"0.5",filter:"alpha(opacity=50)","text-decoration":"none","font-family":"'Helvetica Neue', Helvetica, Arial, sans-serif",cursor:"pointer"}).bind("click",function(){e(r)._3xcloud("update",o())});var f=e("<a>").text("<").css({position:"absolute",top:"50%",width:"30px",height:"30px","margin-top":"-30px",left:"15px","font-size":"40px","font-weight":"100","line-height":"30px",color:"white","text-align":"center",border:"3px solid white","border-radius":"23px","-webkit-border-radius":"23px","-moz-border-radius":"23px",background:"#222",opacity:"0.5",filter:"alpha(opacity=50)","text-decoration":"none","font-family":"'Helvetica Neue', Helvetica, Arial, sans-serif",cursor:"pointer"}).bind("click",function(){e(r)._3xcloud("update",u())});f.appendTo(this);a.appendTo(this)}setInterval(function(){var t=e(r).data().slideshow;if(i.run){e(r)._3xcloud("update",o())}},n.interval)}else if(typeof t==="string"){if(t=="pause"){e(this).data().slideshow.run=false}else if(t=="resume"){e(this).data().slideshow.run=true}else{e.error("The 3xcloud slideshow does not have a method called "+t)}}return this}};e._3xcloudSettings={company:"3xlogic",apiKey:"",url:"https://3xcloud.net/webclient",port:"80",slideShowDefault:{cameras:[],animation:false,interval:7e3,showMenu:false,changeOn:"click"},defaultConfig:{caption:false,ratio:false,captionStyle:null,captionClass:null}};e._3xcloudInfo=function(t){var n=e.extend({},e._3xcloudSettings,t);e._3xcloudSettings=n};e.fn._3xcloud=function(t){if(i[t]){return i[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return i.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery._3xcloud")}}})(jQuery);