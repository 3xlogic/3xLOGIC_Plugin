(function(e,t,n,r){var i={init:function(t){t.camera-=1;var n=t.camera;var r=this;var i=e.extend({},e._3xcloudSettings,t.settings);var s=e.extend({},e._3xcloudSettings.defaultConfig,t.config);var o=e("<div>").appendTo(this);e(o).css({width:"100%",height:"100%","background-color":"black",overflow:"hidden"});var u=e(o);var a=function(){if(s.caption){e.getJSON(i.url+"info/?callback=?",{key:i.apiKey,cam:n},function(t){var n=e("<label>").text(t[0].name);u.css({position:"relative"});e(n).appendTo(u);e(n).css({position:"absolute",top:"0","z-index":"2",left:"0",color:"white","background-color":"black",width:"100%","text-align":"center",opacity:"0.6"}).data("info",t[0]);if(s.captionStyle){e(n).css(s.captionStyle)}if(s.captionClass){e(n).addClass(s.captionClass)}})}};var f=function(){if(s.mobile){return"350x350"}else{return u.width()+"x"+u.height()}};var l=function(){if(e(r).find("img").data()._3xlogic){return e(r).find("img").data()._3xlogic.cam}else{return n}};var c=function(){if(e(r).find("img").data()._3xlogic){if(!e(r).find("img").data()._3xlogic.stream){return false}}};var h=function(){var e=Math.floor(Math.random()*1e12);var t=l();var n=i.url+"video/?key="+i.apiKey+"&cam="+t;n+="&resolution="+f()+"&"+e;return n};var p=function(){var t=e("<img src='"+h()+"'>").data("_3xlogic",{url:i.url+"video/?key="+i.apiKey+"&cam="+n,cam:n,config:s,setting:i,stream:true});return t};var d=function(){u.find("img").bind("load",function(){if(u.find("img").data()._3xlogic){if(!u.find("img").data()._3xlogic.stream){return false}}e(this).attr("src",h());if(!s.ratio){var t=e(this).width()/e(this).height();if(t<7&&t>2){e(this).attr("width","100%");if(e(this).height()>u.height()){e(this).css({height:u.height()+"px"})}e(this).css("margin-top",(u.height()-e(this).height())/2+u.scrollTop()+"px");e(this).css("margin-left",(u.width()-e(this).width())/2+u.scrollLeft()+"px")}else{e(this).css({width:"100%",height:"100%"})}}else{if(e(this).height()>u.height()){e(this).css({height:u.height()+"px"})}if(e(this).width()>u.width()){e(this).css({width:u.width()+"px"})}e(this).css("margin-top",(u.height()-e(this).height())/2+u.scrollTop()+"px");e(this).css("margin-left",(u.width()-e(this).width())/2+u.scrollLeft()+"px");var t=e(this).width()/e(this).height();if(t<7&&t>2){e(this).attr("width","100%")}}})};var v=e("<img src='"+i.url+"img/3xloader.png'/>").css({width:"100%",height:"100%"});e(u).html(v).delay(1e3).queue(function(){e(this).html(p());d();a()});return this},update:function(t){t-=1;var n=e(this).find("img").data()._3xlogic;var r=this;e(this).find("img").fadeOut(100);n.cam=t;if(n.config.caption){e(r).find("label").hide();e.getJSON(n.setting.url+"info/?callback=?",{key:n.setting.apiKey,cam:t},function(t){e(r).find("label").show();e(r).find("label").text(t[0].name)})}var i=e(this).height();var s=e(this).width();var o=n.setting.url+"video/?key="+n.setting.apiKey+"&cam="+t+"&resolution="+s+"x"+i;e(this).find("img").attr("src",o);e(this).find("img").one("load",function(){e(this).fadeIn(100)});return this},pause:function(){e(this).find("img").data()._3xlogic.stream=false;return this},resume:function(){var t=e(this).find("img").data()._3xlogic;var n=t.url+"&resolution="+e(this).parent().width()+"x"+e(this).parent().height();t.stream=true;e(this).find("img").attr("src",n);return this},snapshot:function(){var t=e(this).find("img").data()._3xlogic;var n=t.cam;var r=t.setting.url+"snapshot/?key="+t.setting.apiKey+"&cam="+n+"&resolution=fullsize";open(r,"_blank");return this},slideshow:function(t){if(typeof t==="object"||typeof t==="undefined"){var n=e.extend({},e._3xcloudSettings.slideShowDefault,t);var r=this;var i=Array();e(this).data("slideshow",{camera:0,run:true});e(this).css("overflow","hidden");var s=e(this).data().slideshow;if(n.cameras.length<1){return this}for(var o=0;o<n.cameras.length;o++){i[o]=e("<div>");var u=n.cameras[o];i[o]._3xcloud({camera:u});i[o].hide();i[o].appendTo(r)}var a=function(){var e=s.camera+1;if(e>n.cameras.length-1){s.camera=0;return 0}else{s.camera=e;return e}};var f=function(){for(var e=0;e<i.length;e++){i[e]._3xcloud("pause");i[e].hide()}};i[0].show();var l=function(){var e=s.camera-1;if(e<0){s.camera=n.cameras.length-1;return s.camera}else{s.camera=e;return e}};var c=function(){var e=s.camera;var t=l();i[e].hide();i[t].show()};var h=function(){var e=s.camera;var t=a();i[e].hide();i[t].show()};if(t.showMenu){e(this).css("position","relative");var p=e("<a>").text(">").css({position:"absolute",top:"50%",width:"30px",height:"30px","margin-top":"-30px",right:"15px","font-size":"40px","font-weight":"100","line-height":"30px",color:"white","text-align":"center",border:"3px solid white","border-radius":"23px","-webkit-border-radius":"23px","-moz-border-radius":"23px",background:"#222",opacity:"0.5",filter:"alpha(opacity=50)","text-decoration":"none","font-family":"Arial, sans-serif",cursor:"pointer"}).bind("click",function(){h()}).hover(function(){e(this).css({opacity:"0.9"})},function(){e(this).css({opacity:"0.5"})});var d=e("<a>").text("<").css({position:"absolute",top:"50%",width:"30px",height:"30px","margin-top":"-30px",left:"15px","font-size":"40px","font-weight":"100","line-height":"30px",color:"white","text-align":"center",border:"3px solid white","border-radius":"23px","-webkit-border-radius":"23px","-moz-border-radius":"23px",background:"#222",opacity:"0.5",filter:"alpha(opacity=50)","text-decoration":"none","font-family":"Arial, sans-serif",cursor:"pointer"}).bind("click",function(){c()}).hover(function(){e(this).css({opacity:"0.9"})},function(){e(this).css({opacity:"0.5"})});d.appendTo(this);p.appendTo(this)}if(n.autoRun){setInterval(function(){var t=e(r).data().slideshow;if(s.run){h()}},n.interval)}}else if(typeof t==="string"){if(t=="pause"){e(this).data().slideshow.run=false}else if(t=="resume"){e(this).data().slideshow.run=true}else if(t=="active"){return e(this).data().slideshow.camera}else{e.error("The 3xcloud slideshow does not have a method called "+t)}}return this}};e._3xcloudSettings={company:"3xlogic",apiKey:"",url:"http://10.4.2.4/webclient/api/1.0/",port:"80",slideShowDefault:{cameras:[],autoRun:false,interval:8e3,showMenu:false,changeOn:"click"},defaultConfig:{caption:false,ratio:false,captionStyle:null,captionClass:null,preload:true,mobile:false}};e._3xcloudInfo=function(t){var n=e.extend({},e._3xcloudSettings,t);e._3xcloudSettings=n};e.fn._3xcloud=function(t){if(i[t]){return i[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return i.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery._3xcloud")}}})(jQuery);